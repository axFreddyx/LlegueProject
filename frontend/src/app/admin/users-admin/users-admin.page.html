<ion-header>
    <ion-toolbar color="primary">
        <ion-buttons slot="start">
            <ion-menu-button menu="menuId"></ion-menu-button>
            <ion-back-button text="Regresar"></ion-back-button>
        </ion-buttons>
        <ion-title class="text-center">
            <div class="header-title">
                <img src="assets/img/escuela.png" alt="" class="logo-title">
            </div>
        </ion-title>
        <ion-buttons slot="end">
            <ion-button routerLink="/perfil" title="Mi perfil">
                <ion-icon name="person-circle-outline"></ion-icon>
            </ion-button>
        </ion-buttons>
    </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
    <div class="container">

        <h1 class="titulo text-center">Ver Administradores</h1>
        <div class="text-center">
            <ion-button class="cuenta-btn" fill="solid" size="large" (click)="redirect()">
                <ion-icon slot="start" name="person-add-outline"></ion-icon>
                Registrar administrador
            </ion-button>
        </div>
        <ion-list lines="none">
            <ion-button (click)="selectingAdmins()" *ngIf="!isSelecting && admins.length !== 0" expand="block"
                fill="clear" shape="round">
                <ion-icon name="checkmark-outline" slot="start"></ion-icon>
                Seleccionar administradores
            </ion-button>
            <ion-button (click)="notSelectingAdmins()" color="medium" *ngIf="isSelecting" expand="block" fill="clear"
                shape="round">
                <ion-icon name="close-outline" slot="start"></ion-icon>
                Cancelar selección
            </ion-button>
            <div class="acciones" *ngIf="isSelecting && admins.length !== 0">
                <ion-checkbox slot="start" color="primary" [(ngModel)]="allSelected"
                    (ionChange)="toggleSelectAll($event)" aria-label="Seleccionar todos los administradores">
                </ion-checkbox>
                <label (click)="toggleSelectAllLabel()" class="select-all-label">
                    Seleccionar todos
                </label>
                <ion-button (click)="openAlertDelete()" size="small" fill="outline" color="danger">
                    ❌ Eliminar
                </ion-button>
            </div>
            <ion-card>
                <ion-card-header *ngIf="admins.length === 0">
                    <ion-card-title>No hay administradores registrados</ion-card-title>
                </ion-card-header>
                <ion-card-content *ngIf="admins.length === 0">
                    <p>Aún no hay administradores registrados. Puedes registrar nuevos administradores haciendo clic en
                        el botón "Registrar administrador" arriba.</p>
                </ion-card-content>
            </ion-card>
            <ion-item class="admin-item" *ngFor="let a of admins" (click)="isSelecting ? clickAdmin(a) : null">
                <!-- CHECKBOX -->
                <ion-checkbox disabled *ngIf="isSelecting" slot="start" color="primary" [(ngModel)]="a.selected"
                    (click)="selectAdmins(a)"
                    [attr.aria-label]="'Seleccionar administrador ' + a.nombre + ' ' + a.apellidos"></ion-checkbox>

                <ion-avatar slot="start" [style.margin-left]="isSelecting ? '10px' : '0'">
                    <img src="assets/img/ejemplo.jpg" alt="{{a.nombre}}" />
                </ion-avatar>
                <ion-label>
                    <h2>{{a.nombre}} {{a.apellidos}}</h2>
                    <p>ID: {{a.id}}</p>
                    <div class="acciones" *ngIf="!isSelecting">
                        <ion-button (click)="redirectToEditAdmin(a)" size="small" fill="outline" color="primary">
                            📝 Editar
                        </ion-button>
                        <ion-button (click)="openAlertDelete(a)" size="small" fill="outline" color="danger">
                            ❌ Eliminar
                        </ion-button>
                    </div>
                </ion-label>
            </ion-item>
            <ion-infinite-scroll threshold="1px" (ionInfinite)="getAdmins($event)">
                <ion-infinite-scroll-content loadingSpinner="bubbles" loadingText="Cargando más alumnos...">
                </ion-infinite-scroll-content>
            </ion-infinite-scroll>
        </ion-list>
    </div>

    <ion-alert #deleteAlert [header]="alertHeaderDelete" [buttons]="alertButtonsDelete"></ion-alert>

</ion-content>